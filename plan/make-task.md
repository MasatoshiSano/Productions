# タスク分割・整理ガイド（Django開発向け）

このドキュメントでは、実装要件定義書（`specification.md`）と設計方針書（`design-doc.md`）に基づき、Djangoアプリケーション開発におけるタスクを分割・整理するプロセスとベストプラクティスについて説明します。

---

## 🧑‍💻 役割と責任

タスク分割担当者は以下の役割と責任を持ちます：

- Djangoエンジニアのプロフェッショナルとして機能する
- `specification.md` と `design-doc.md` に基づき、Juniorエンジニアでも迷わず開発を進められるようにタスクを分割・整理する
- 不明瞭な点があれば、質問を通じて明確化する

---

## 🔍 タスク分割プロセス

### 1. 入力ドキュメントの確認

作業ブランチに対応するディレクトリにある以下のファイルを確認します：

- `specification.md`（実装要件定義書）
- `design-doc.md`（設計方針書）

### 2. タスクの分割と整理

以下の原則に基づき、タスクを分割・整理します：

- **動作保証単位で分割**：ビュー、フォーム、モデル、URLなど機能単位
- **TDD原則に従う**：まずテストを書いてから実装
- **確認方法を明記**：自動テストで確認できない部分は手動確認手順を記載

#### ✅ 完了基準

- `python manage.py test` による **テストエラーなし**
- `flake8` や `black` による **リントエラーなし**
- `python manage.py runserver` で **起動確認済み**

---

## ✏️ 関連ドキュメントの更新

- `specification.md`：要件の見直しがあれば更新
- `design-doc.md`：設計や技術選定の修正があれば更新

---

## 📦 成果物と出力形式

以下を **Markdown形式**で作成・更新します：

- タスク整理文書：`context/<ブランチ名>/task.md`
- 実装要件定義書（更新がある場合）：`specification.md`
- 設計方針書（更新がある場合）：`design-doc.md`

---

## 🗂️ `task.md` の構成例（Django版）

```markdown
# [機能名] タスク一覧

## 📋 概要

ユーザー登録と認証機能を実装する。

## ✅ タスクリスト

### フェーズ1: モデルとフォーム作成

1. **Userモデルの拡張（AbstractUser）**
   - 概要: Djangoのユーザーモデルをカスタマイズして追加情報（例：部署、あだ名）を持たせる
   - 完了条件:
     - [ ] カスタムUserモデルを作成
     - [ ] `AUTH_USER_MODEL`に設定済み
   - 動作確認:
     - [ ] `python manage.py test` で通過
     - [ ] 管理画面で作成・編集ができる
   - メモ: マイグレーションに注意（初期段階で設定必須）

2. **User登録フォームの作成**
   - 概要: モデルフォームで登録画面の入力項目を制御
   - 完了条件:
     - [ ] フォームのバリデーション設定
     - [ ] 登録に成功したらログイン画面へリダイレクト
   - 動作確認:
     - [ ] フォーム入力 → 登録完了の手動テスト
     - [ ] エラー表示確認
   - メモ: `form.as_p` を使用し、後でテンプレート調整予定

### フェーズ2: 認証処理とビュー実装

3. **ログイン／ログアウトビューの実装**
   - 概要: Django標準の認証ビューを用いて実装
   - 完了条件:
     - [ ] `LoginView`, `LogoutView` のURLルーティング
     - [ ] ログイン時のセッション管理確認
   - 動作確認:
     - [ ] `/login/` 画面でログインできること
     - [ ] `/logout/` でセッションが切れること
   - メモ: CSRFトークン忘れずに

4. **プロフィール画面の作成**
   - 概要: ログイン後、ユーザーのプロフィールを表示
   - 完了条件:
     - [ ] ログインユーザーの情報を取得・表示
     - [ ] 編集画面へのリンク追加
   - 動作確認:
     - [ ] 手動でログイン → プロフィール表示確認

### フェーズ3: テストと仕上げ

5. **単体テスト作成**
   - 概要: 上記モデル・フォーム・ビューに対するテストコード作成
   - 完了条件:
     - [ ] `tests/test_models.py`
     - [ ] `tests/test_views.py`
   - 動作確認:
     - [ ] `python manage.py test` で全テストパス
   - メモ: `Client()` を活用したログインセッションテスト

---

## ❓ 未解決の課題・確認事項

- ユーザー登録時の部署選択に外部マスターデータが必要か？
- アカウントロックやパスワードポリシーの要件はあるか？

---

## 🔗 関連ドキュメント

- 実装要件: [specification.md](./specification.md)
- 設計方針: [design-doc.md](./design-doc.md)